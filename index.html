<!DOCTYPE html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Welcome</title>
    <link rel="stylesheet" href="stylesheets/foundation.css">
    <link rel="stylesheet" href="stylesheets/app.css">
    <script src="javascripts/modernizr.foundation.js"></script>
</head>
<body>

<div class="row">
    <div class="five columns centered">
        <h1><img src="http://placehold.it/400x100&text=Logo" /></h1>
    </div>
</div>

<div class="row">
    <div class="seven columns offset-by-two">
        <input id="youtubeurl" type="text" placeholder="Enter Youtube URL" value="http://www.youtube.com/watch?v=jzUsBUoaMNo" />
    </div>
    <div class="two columns pull-one">
        <a id="playButton" class="radius button left" href="#">Start It!</a>
    </div>
</div>

<div class="row">
    <div class="nine columns push-three">
        <div class="flex-video">
            <div id="player"></div>
        </div>
    </div>

    <div class="three columns pull-nine">
        <div id="feed" class="panel callout radius">
            <h5 style="color:white;">Video Information</h5>
            <hr>
            <ul class="side-nav">
                <li><h6>Title : </h6><span id="videoTitle">-</span></li>
                <li><h6>Description : </h6><span id="videoDescription">-</span></li>
                <li><h6>Duration : </h6><span id="videoDuration">-</span></li>
                <li><h6>View : </h6><span id="videoViewTimes">-</span></li>
                <li><h6>Rating : </h6><span id="videoRating">-</span></li>
                <li><h6>Like : </h6><span id="videoLikeCount">-</span></li>
            </ul>
        </div>
        <p><img src="http://placehold.it/320x240&text=Ad" /></p>
    </div>
</div>

<!-- Footer -->

<footer class="row">
    <div class="twelve columns">
        <hr />
        <div class="row">
            <div class="twelve columns">
                <p>&copy; Copyright no one at all.</p>
            </div>
        </div>
    </div>
</footer>

<!-- Included JS Files (Compressed) -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>
<script src="javascripts/foundation.min.js"></script>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>

<!-- Initialize JS Plugins -->
<script src="javascripts/app.js"></script>

<script>

    var tag = document.createElement('script');
    tag.src = "//www.youtube.com/iframe_api";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    var player;
    function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
            height: '340',
            width: '520',
            events: {
                'onReady': onPlayerReady,
                'onStateChange': onPlayerStateChange
            }
        });
    }

    function onPlayerReady(event) {
        setInterval(updatePlayerInfo, 250);
    }

    function onPlayerStateChange(event) {
        if (event.data == YT.PlayerState.PLAYING) {
            done = true;
        }
        else if(event.data == YT.PlayerState.ENDED) {
            player.loadVideoById(parseYoutubeUrl($("#youtubeurl").val()));
        }
    }
    function stopVideo() {
        player.stopVideo();
    }

    function updateHTML(elmId, value) {
        document.getElementById(elmId).innerHTML = value;
    }

    function parseYoutubeUrl(url){
        var regExp = /.*(?:youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/;
        var match = url.match(regExp);
        if (match&&match[1].length==11){
            return match[1];
        }else{
            alert("Invalid Youtube Url");
        }
    }
    
    $(window).load(function() {
        $("#playButton").click(function(){
            youtubeVideoId = parseYoutubeUrl($("#youtubeurl").val());
            player.loadVideoById(youtubeVideoId);

            var youtubeFeed = "https://gdata.youtube.com/feeds/api/videos/";
            $.getJSON(youtubeFeed + youtubeVideoId + "?v=2&alt=jsonc",function(response){
                updateHTML("videoTitle", response.data.title);
                updateHTML("videoDescription", response.data.description);
                updateHTML("videoDuration", response.data.duration);
                updateHTML("videoViewTimes", response.data.viewCount + " time(s)");
                updateHTML("videoRating", response.data.rating + " of 5");
                updateHTML("videoLikeCount", response.data.likeCount);
            });
        });
    });
</script>

</body>
</html>
